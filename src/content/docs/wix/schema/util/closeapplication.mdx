---
title: "CloseApplication element (Util extension)"
---

import BlockWrapper from '@components/BlockWrapper.astro';
import BlockReference from '@components/BlockReference.astro';
import BlockDefList from '@components/BlockDefList.astro';

Closes applications or schedules a reboot if application cannot be closed.


## Attributes

<BlockWrapper>

  <BlockReference
    content={{
      title: "CloseMessage",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  Optionally sends a close message to the application. Default is no.
  </BlockReference>

  <BlockReference
    content={{
      title: "Condition",
      type: "string"
    }}
  >
  Condition that determines if the application should be closed. Must be blank or evaluate to true
   for the application to be scheduled for closing.
  </BlockReference>

  <BlockReference
    content={{
      title: "Description",
      type: "string"
    }}
  >
  Description to show if application is running and needs to be closed.
  </BlockReference>

  <BlockReference
    content={{
      title: "ElevatedCloseMessage",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  Optionally sends a close message to the application from deffered action without impersonation. Default is no.
  </BlockReference>

  <BlockReference
    content={{
      title: "ElevatedEndSessionMessage",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  Sends WM_QUERYENDSESSION then WM_ENDSESSION messages to the application from a deffered action without impersonation. Default is "no".
  </BlockReference>

  <BlockReference
    content={{
      title: "EndSessionMessage",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  Sends WM_QUERYENDSESSION then WM_ENDSESSION messages to the application. Default is "no".
  </BlockReference>

  <BlockReference
    content={{
      title: "Id",
      type: "string"
    }}
  >
  Identifier for the close application (primary key). If the Id is not specified, one will be generated.
  </BlockReference>

  <BlockReference
    content={{
      title: "PromptToContinue",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  When this attribute is set to "yes", the user will be prompted when the application is still running. The Description attribute must contain the message to
   display in the prompt. The prompt occurs before executing any of the other options and gives the options to "Abort", "Retry", or "Ignore". Abort will cancel
   the install. Retry will attempt the check again and if the application is still running, prompt again. "Ignore" will continue and execute any other options
   set on the CloseApplication element. The default is "no".
  </BlockReference>

  <BlockReference
    content={{
      title: "Property",
      type: "string"
    }}
  >
  Property to be set if application is still running. Useful for launch conditions or to conditionalize custom UI to ask user to shut down apps.
  </BlockReference>

  <BlockReference
    content={{
      title: "RebootPrompt",
      type: "wxs:YesNoTypeUnion"
    }}
  >
  Optionally prompts for reboot if application is still running.
   The TerminateProcess attribute must be "no" or not specified if this attribute is "yes".
   The default is "yes".
  </BlockReference>

  <BlockReference
    content={{
      title: "Sequence",
      type: "wxs:Integer"
    }}
  >
  Optionally orders the applications to be closed.
  </BlockReference>

  <BlockReference
    content={{
      title: "Target",
      type: "string",
      required: true
    }}
  >
  Name of the exectuable to be closed. This should only be the file name.
  </BlockReference>

  <BlockReference
    content={{
      title: "TerminateProcess",
      type: "wxs:Integer"
    }}
  >
  Attempts to terminates process and return the attribute value as the process's exit code if the application is still running after sending any requested close and/or end session messages.
   If this attribute is specified, the RebootPrompt attribute must be "no".
  </BlockReference>

  <BlockReference
    content={{
      title: "Timeout",
      type: "wxs:Integer"
    }}
  >
  Optional time in seconds to wait for the application to exit after the close and/or end session messages. If the application is still running after the timeout then
   the RebootPrompt or TerminateProcess attributes will be considered. The default value is "5" seconds.
  </BlockReference>

</BlockWrapper>


## Parents

<BlockDefList content={[
    {
      title: "Bundle (Wxs extension)",
      link: "../../wxs/bundle"
    },
    {
      title: "Package (Wxs extension)",
      link: "../../wxs/package"
    },
    {
      title: "Module (Wxs extension)",
      link: "../../wxs/module"
    },
    {
      title: "Fragment (Wxs extension)",
      link: "../../wxs/fragment"
    }
  ]}
/>